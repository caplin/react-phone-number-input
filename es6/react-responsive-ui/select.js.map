{"version":3,"sources":["../../source/react-responsive-ui/select.js"],"names":["React","PureComponent","PropTypes","ReactDOM","flat","styler","classNames","submit_parent_form","get_scrollbar_width","Empty_value_option_value","value_prop_type","oneOfType","string","number","bool","Select","props","options","value","autocomplete","children","menu","toggler","onChange","Error","state","matching_options","get_matching_options","Children","forEach","element","label","fallback","nativeExpanded","document","addEventListener","document_clicked","setState","javascript","resize_native_expanded_select","window","previous_props","previous_state","expanded","height","should_animate","undefined","calculate_height","removeEventListener","id","upward","scroll","alignment","saveOnIcons","native","disabled","placeholder","error","indicateInvalid","style","className","list_height","get_options","list_style","styles","list","is_scrollable","maxHeight","overflow","overflown","list_items","map","index","icon","render_list_item","wrapper_style","wrapper","textAlign","selected","get_selected_option","markup","select","ref","on_key_down_in_container","render_selected_item","menu_toggler","cloneElement","onClick","toggle","render_static","scrollbarPadding","focused_option_value","is_focused","item_style","marginRight","button","extra_props","event","item_clicked","get_option_key","type","Separator","render_selected_item_only","native_expanded_select_container","concise","autocomplete_width","autocomplete_input_value","selected_label","get_selected_option_label","selected_text","on_autocomplete_input_change","on_key_down","selected_flex_wrapper","title","arrow","name","value_is_empty","native_select_on_change","render_native_select_options","child","empty_option_is_selected","empty_option_present","rendered_options","option","unshift","get_option","filter","x","indexOf","option_index","maxItems","length","vertical_padding","preventDefault","focusUponSelection","focus","callback","autocompleteShowAll","slice","i","option_element","findDOMNode","scrollTop","offsetTop","gravity","offsetHeight","list_dom_node","border","parseInt","getComputedStyle","borderTopWidth","scrollHeight","firstChild","paddingTop","scrollable_list_height","toLowerCase","verbose","propTypes","arrayOf","shape","node","isRequired","func","object","oneOf","onTabOut","onToggle","defaultProps","target","width","offsetWidth","toggle_options","setTimeout","scroll_to","dont_focus_after_toggle","selected_option","options_list","contains","ctrlKey","altKey","shiftKey","metaKey","keyCode","previous","previous_focusable_option","show_option","next","next_focusable_option","input","separator"],"mappings":"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","file":"select.js","sourcesContent":["// https://github.com/halt-hammerzeit/react-responsive-ui/blob/master/source/select.js\n\nimport React, { PureComponent, PropTypes } from 'react'\nimport ReactDOM from 'react-dom'\nimport { flat as styler } from 'react-styling'\nimport classNames from 'classnames'\n\nimport { submit_parent_form, get_scrollbar_width } from './misc/dom'\n\n// Possible enhancements:\n//\n//  * If the menu is close to a screen edge,\n//    automatically reposition it so that it fits on the screen\n//  * Maybe show menu immediately above the toggler\n//    (like in Material design), not below it.\n//\n// https://material.google.com/components/menus.html\n\nconst Empty_value_option_value = ''\n\nconst value_prop_type = React.PropTypes.oneOfType\n([\n\tReact.PropTypes.string,\n\tReact.PropTypes.number,\n\tReact.PropTypes.bool\n])\n\nexport default class Select extends PureComponent\n{\n\tstatic propTypes =\n\t{\n\t\t// A list of selectable options\n\t\toptions    : PropTypes.arrayOf\n\t\t(\n\t\t\tPropTypes.shape\n\t\t\t({\n\t\t\t\t// Option value (may be `undefined`)\n\t\t\t\tvalue : value_prop_type,\n\t\t\t\t// Option label (may be `undefined`)\n\t\t\t\tlabel : React.PropTypes.string,\n\t\t\t\t// Option icon\n\t\t\t\ticon  : React.PropTypes.node\n\t\t\t})\n\t\t),\n\n\t\t// HTML form input `name` attribute\n\t\tname       : PropTypes.string,\n\n\t\t// Label which is placed above the select\n\t\tlabel      : PropTypes.string,\n\n\t\t// Placeholder (like \"Choose\")\n\t\tplaceholder : PropTypes.string,\n\n\t\t// Whether to use native `<select/>`\n\t\tnative      : PropTypes.bool.isRequired,\n\n\t\t// Whether to use native `<select/>` when expanded\n\t\tnativeExpanded : PropTypes.bool.isRequired,\n\n\t\t// Show icon only for selected item,\n\t\t// and only if `concise` is `true`.\n\t\tsaveOnIcons : PropTypes.bool,\n\n\t\t// Disables this control\n\t\tdisabled   : PropTypes.bool,\n\n\t\t// Selected option value\n\t\tvalue      : value_prop_type,\n\n\t\t// Is called when an option is selected\n\t\tonChange   : PropTypes.func,\n\n\t\t// (exotic use case)\n\t\t// Falls back to a plain HTML input\n\t\t// when javascript is disabled (e.g. Tor)\n\t\tfallback  : PropTypes.bool.isRequired,\n\n\t\t// CSS class\n\t\tclassName  : PropTypes.string,\n\n\t\t// CSS style object\n\t\tstyle      : PropTypes.object,\n\n\t\t// If this flag is set to `true`,\n\t\t// and `icon` is specified for a selected option,\n\t\t// then the selected option will be displayed\n\t\t// as icon only, without the label.\n\t\tconcise    : PropTypes.bool,\n\n\t\t// If set to `true`, autocompletion is available\n\t\t// upon expanding the options list.\n\t\tautocomplete : PropTypes.bool,\n\n\t\t// If set to `true`, autocomple will show all\n\t\t// matching options instead of just `maxItems`.\n\t\tautocompleteShowAll : PropTypes.bool,\n\n\t\t// Options list alignment (\"left\", \"right\")\n\t\talignment  : PropTypes.oneOf(['left', 'right']),\n\n\t\t// If `menu` flag is set to `true`\n\t\t// then it's gonna be a dropdown menu\n\t\t// with `children` elements inside.\n\t\tmenu       : PropTypes.bool,\n\n\t\t// If `menu` flag is set to `true`\n\t\t// then `toggler` is the dropdown menu button.\n\t\ttoggler    : PropTypes.element,\n\n\t\t// If `scroll` is `false`, then options list\n\t\t// is not limited in height.\n\t\t// Is `true` by default (scrollable).\n\t\tscroll     : PropTypes.bool.isRequired,\n\n\t\t// If this flag is set to `true`,\n\t\t// then the dropdown expands itself upward.\n\t\t// (as opposed to the default downward)\n\t\tupward     : PropTypes.bool,\n\n\t\t// Maximum items fitting the options list height (scrollable).\n\t\t// In case of `autocomplete` that's the maximum number of matched items shown.\n\t\t// Is `6` by default.\n\t\tmaxItems   : PropTypes.number.isRequired,\n\n\t\t// Is `true` by default (only when the list of options is scrollable)\n\t\tscrollbarPadding : PropTypes.bool,\n\n\t\tfocusUponSelection : PropTypes.bool.isRequired,\n\n\t\tonTabOut : PropTypes.func,\n\n\t\tonToggle : PropTypes.func\n\n\t\t// transition_item_count_min : PropTypes.number,\n\t\t// transition_duration_min : PropTypes.number,\n\t\t// transition_duration_max : PropTypes.number\n\t}\n\n\tstatic defaultProps =\n\t{\n\t\talignment          : 'left',\n\t\tscroll             : true,\n\t\tmaxItems           : 6,\n\t\tscrollbarPadding   : true,\n\t\tfocusUponSelection : true,\n\t\tfallback           : false,\n\t\tnative             : false,\n\t\tnativeExpanded     : false,\n\n\t\t// transition_item_count_min : 1,\n\t\t// transition_duration_min : 60, // milliseconds\n\t\t// transition_duration_max : 100 // milliseconds\n\t}\n\n\tstate = {}\n\n\tconstructor(props)\n\t{\n\t\tsuper(props)\n\n\t\t// Shouldn't memory leak because\n\t\t// the set of options is assumed to be constant.\n\t\tthis.options = {}\n\n\t\tconst\n\t\t{\n\t\t\tvalue,\n\t\t\tautocomplete,\n\t\t\toptions,\n\t\t\tchildren,\n\t\t\tmenu,\n\t\t\ttoggler,\n\t\t\tonChange\n\t\t}\n\t\t= props\n\n\t\tif (autocomplete)\n\t\t{\n\t\t\tif (!options)\n\t\t\t{\n\t\t\t\tthrow new Error(`\"options\" property is required for an \"autocomplete\" select`)\n\t\t\t}\n\n\t\t\tthis.state.matching_options = this.get_matching_options(options, value)\n\t\t}\n\n\t\tif (children && !menu)\n\t\t{\n\t\t\tReact.Children.forEach(children, (element) =>\n\t\t\t{\n\t\t\t\tif (!element.props.value)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error(`You must specify \"value\" prop on each child of <Select/>`)\n\t\t\t\t}\n\n\t\t\t\tif (!element.props.label)\n\t\t\t\t{\n\t\t\t\t\tthrow new Error(`You must specify \"label\" prop on each child of <Select/>`)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tif (menu && !toggler)\n\t\t{\n\t\t\tthrow new Error(`Supply a \"toggler\" component when enabling \"menu\" in <Select/>`)\n\t\t}\n\n\t\tif (!menu && !onChange)\n\t\t{\n\t\t\tthrow new Error(`\"onChange\" property must be specified for <Select/>`)\n\t\t}\n\t}\n\n\t// Client side rendering, javascript is enabled\n\tcomponentDidMount()\n\t{\n\t\tconst { fallback, nativeExpanded } = this.props\n\n\t\tdocument.addEventListener('click', this.document_clicked)\n\n\t\tif (fallback)\n\t\t{\n\t\t\tthis.setState({ javascript: true })\n\t\t}\n\n\t\tif (nativeExpanded)\n\t\t{\n\t\t\tthis.resize_native_expanded_select()\n\t\t\twindow.addEventListener('resize', this.resize_native_expanded_select)\n\t\t}\n\t}\n\n\tcomponentDidUpdate(previous_props, previous_state)\n\t{\n\t\tconst { nativeExpanded, value } = this.props\n\t\tconst { expanded, height } = this.state\n\n\t\tif (expanded !== previous_state.expanded)\n\t\t{\n\t\t\tif (expanded && this.should_animate())\n\t\t\t{\n\t\t\t\tif (height === undefined)\n\t\t\t\t{\n\t\t\t\t\tthis.calculate_height()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// If the `value` changed then resize the native expanded `<select/>`\n\t\tif (nativeExpanded && value !== previous_props.value)\n\t\t{\n\t\t\tthis.resize_native_expanded_select()\n\t\t}\n\t}\n\n\tcomponentWillUnmount()\n\t{\n\t\tconst { nativeExpanded } = this.props\n\n\t\tdocument.removeEventListener('click', this.document_clicked)\n\n\t\tif (nativeExpanded)\n\t\t{\n\t\t\twindow.removeEventListener('resize', this.resize_native_expanded_select)\n\t\t}\n\t}\n\n\trender()\n\t{\n\t\tconst\n\t\t{\n\t\t\tid,\n\t\t\tupward,\n\t\t\tscroll,\n\t\t\tchildren,\n\t\t\tmenu,\n\t\t\ttoggler,\n\t\t\talignment,\n\t\t\tautocomplete,\n\t\t\tsaveOnIcons,\n\t\t\tfallback,\n\t\t\tnative,\n\t\t\tnativeExpanded,\n\t\t\tdisabled,\n\t\t\tplaceholder,\n\t\t\tlabel,\n\t\t\terror,\n\t\t\tindicateInvalid,\n\t\t\tstyle,\n\t\t\tclassName\n\t\t}\n\t\t= this.props\n\n\t\tconst\n\t\t{\n\t\t\texpanded,\n\t\t\tlist_height\n\t\t}\n\t\t= this.state\n\n\t\tconst options = this.get_options()\n\n\t\tlet list_style = styles.list\n\n\t\t// Makes the options list scrollable (only when not in `autocomplete` mode).\n\t\tif (this.is_scrollable() && this.state.list_height !== undefined)\n\t\t{\n\t\t\tlist_style = { ...list_style, maxHeight: `${list_height}px` }\n\t\t}\n\n\t\tconst overflow = scroll && options && this.overflown()\n\n\t\tlet list_items\n\n\t\t// If a list of options is supplied as an array of `{ value, label }`,\n\t\t// then transform those elements to <buttons/>\n\t\tif (options)\n\t\t{\n\t\t\tlist_items = options.map(({ value, label, icon }, index) =>\n\t\t\t{\n\t\t\t\treturn this.render_list_item({ index, value, label, icon: !saveOnIcons && icon, overflow })\n\t\t\t})\n\t\t}\n\t\t// Else, if a list of options is supplied as a set of child React elements,\n\t\t// then render those elements.\n\t\telse\n\t\t{\n\t\t\tlist_items = React.Children.map(children, (element, index) =>\n\t\t\t{\n\t\t\t\tif (!element)\n\t\t\t\t{\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\treturn this.render_list_item({ index, element })\n\t\t\t})\n\t\t}\n\n\t\tconst wrapper_style = { ...styles.wrapper, textAlign: alignment }\n\n\t\tconst selected = this.get_selected_option()\n\n\t\tconst markup =\n\t\t(\n\t\t\t<div\n\t\t\t\tref={ ref => this.select = ref }\n\t\t\t\tonKeyDown={ this.on_key_down_in_container }\n\t\t\t\tstyle={ style ? { ...wrapper_style, ...style } : wrapper_style }\n\t\t\t\tclassName={ classNames\n\t\t\t\t(\n\t\t\t\t\t'rrui__select',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__rich'              : fallback,\n\t\t\t\t\t\t'rrui__select--upward'    : upward,\n\t\t\t\t\t\t'rrui__select--expanded'  : expanded,\n\t\t\t\t\t\t'rrui__select--collapsed' : !expanded,\n\t\t\t\t\t\t'rrui__select--disabled'  : disabled\n\t\t\t\t\t},\n\t\t\t\t\tclassName\n\t\t\t\t) }>\n\n\t\t\t\t{/* Currently selected item */}\n\t\t\t\t{ !menu && !native && this.render_selected_item() }\n\n\t\t\t\t{/* Label */}\n\t\t\t\t{/* (this label is placed after the \"selected\" button\n\t\t\t\t     to utilize the CSS `+` selector) */}\n\t\t\t\t{/* If the `placeholder` wasn't specified\n\t\t\t\t    but `label` was and no option is currently selected\n\t\t\t\t    then the `label` becomes the `placeholder`\n\t\t\t\t    until something is selected */}\n\t\t\t\t{ label && (this.get_selected_option() || placeholder) &&\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor={ id }\n\t\t\t\t\t\tclassName={ classNames('rrui__input-label',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'rrui__input-label--invalid' : error && indicateInvalid\n\t\t\t\t\t\t}) }\n\t\t\t\t\t\tstyle={ styles.label }>\n\t\t\t\t\t\t{ label }\n\t\t\t\t\t</label>\n\t\t\t\t}\n\n\t\t\t\t{/* Menu toggler */}\n\t\t\t\t{ menu &&\n\t\t\t\t\t<div\n\t\t\t\t\t\tref={ ref => this.menu_toggler }\n\t\t\t\t\t\tclassName=\"rrui__select__toggler\">\n\t\t\t\t\t\t{ React.cloneElement(toggler, { onClick : this.toggle }) }\n\t\t\t\t\t</div>\n\t\t\t\t}\n\n\t\t\t\t{/* The list of selectable options */}\n\t\t\t\t{/* Math.max(this.state.height, this.props.max_height) */}\n\t\t\t\t{ !native && !nativeExpanded &&\n\t\t\t\t\t<ul\n\t\t\t\t\t\tref={ ref => this.list = ref }\n\t\t\t\t\t\tstyle={ list_style }\n\t\t\t\t\t\tclassName={ classNames\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t'rrui__expandable',\n\t\t\t\t\t\t\t'rrui__expandable--overlay',\n\t\t\t\t\t\t\t'rrui__select__options',\n\t\t\t\t\t\t\t'rrui__shadow',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'rrui__expandable--expanded'                  : expanded,\n\t\t\t\t\t\t\t\t'rrui__select__options--expanded'             : expanded,\n\t\t\t\t\t\t\t\t'rrui__expandable--left-aligned'              : alignment === 'left',\n\t\t\t\t\t\t\t\t'rrui__expandable--right-aligned'             : alignment === 'right',\n\t\t\t\t\t\t\t\t'rrui__select__options--simple-left-aligned'  : !children && alignment === 'left',\n\t\t\t\t\t\t\t\t'rrui__select__options--simple-right-aligned' : !children && alignment === 'right',\n\t\t\t\t\t\t\t\t// CSS selector performance optimization\n\t\t\t\t\t\t\t\t'rrui__select__options--upward'               : upward,\n\t\t\t\t\t\t\t\t'rrui__select__options--downward'             : !upward\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t) }>\n\t\t\t\t\t\t{ list_items }\n\t\t\t\t\t</ul>\n\t\t\t\t}\n\n\t\t\t\t{/* Fallback in case javascript is disabled */}\n\t\t\t\t{ (native || (fallback && !this.state.javascript)) && this.render_static() }\n\n\t\t\t\t{/* Error message */}\n\t\t\t\t{ error && indicateInvalid &&\n\t\t\t\t\t<div className=\"rrui__input-error\">{ error }</div>\n\t\t\t\t}\n\t\t\t</div>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\trender_list_item({ index, element, value, label, icon, overflow }) // , first, last\n\t{\n\t\tconst { disabled, menu, scrollbarPadding } = this.props\n\t\tconst { focused_option_value, expanded } = this.state\n\n\t\t// If a list of options is supplied as a set of child React elements,\n\t\t// then extract values from their props.\n\t\tif (element)\n\t\t{\n\t\t\tvalue = element.props.value\n\t\t}\n\n\t\tconst is_focused = !menu && value === focused_option_value\n\n\t\tlet item_style\n\n\t\t// on overflow the vertical scrollbar will take up space\n\t\t// reducing padding-right and the only way to fix that\n\t\t// is to add additional padding-right\n\t\t//\n\t\t// a hack to restore padding-right taken up by a vertical scrollbar\n\t\tif (overflow && scrollbarPadding)\n\t\t{\n\t\t\titem_style = { marginRight: get_scrollbar_width() + 'px' }\n\t\t}\n\n\t\tlet button\n\n\t\t// If a list of options is supplied as a set of child React elements,\n\t\t// then enhance those elements with extra props.\n\t\tif (element)\n\t\t{\n\t\t\tconst extra_props =\n\t\t\t{\n\t\t\t\tstyle     : item_style ? { ...item_style, ...element.props.style } : element.props.style,\n\t\t\t\tclassName : classNames\n\t\t\t\t(\n\t\t\t\t\t'rrui__select__option',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__select__option--focused' : is_focused\n\t\t\t\t\t},\n\t\t\t\t\telement.props.className\n\t\t\t\t)\n\t\t\t}\n\n\t\t\tconst onClick = element.props.onClick\n\n\t\t\textra_props.onClick = (event) =>\n\t\t\t{\n\t\t\t\tif (menu)\n\t\t\t\t{\n\t\t\t\t\tthis.toggle()\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.item_clicked(value, event)\n\t\t\t\t}\n\n\t\t\t\tif (onClick)\n\t\t\t\t{\n\t\t\t\t\tonClick(event)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tbutton = React.cloneElement(element, extra_props)\n\t\t}\n\t\t// Else, if a list of options is supplied as an array of `{ value, label }`,\n\t\t// then transform those options to <buttons/>\n\t\telse\n\t\t{\n\t\t\tbutton = <button\n\t\t\t\ttype=\"button\"\n\t\t\t\tonClick={ event => this.item_clicked(value, event) }\n\t\t\t\tdisabled={ disabled }\n\t\t\t\ttabIndex=\"-1\"\n\t\t\t\tclassName={ classNames\n\t\t\t\t(\n\t\t\t\t\t'rrui__select__option',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__select__option--focused' : is_focused,\n\t\t\t\t\t\t// CSS selector performance optimization\n\t\t\t\t\t\t'rrui__select__option--disabled' : disabled\n\t\t\t\t\t}\n\t\t\t\t) }\n\t\t\t\tstyle={ item_style }>\n\t\t\t\t{ icon && React.cloneElement(icon, { className: classNames(icon.props.className, 'rrui__select__option-icon') }) }\n\t\t\t\t{ label }\n\t\t\t</button>\n\t\t}\n\n\t\tconst markup =\n\t\t(\n\t\t\t<li\n\t\t\t\tkey={ get_option_key(value) }\n\t\t\t\tref={ ref => this.options[get_option_key(value)] = ref }\n\t\t\t\tclassName={ classNames\n\t\t\t\t(\n\t\t\t\t\t'rrui__expandable__content',\n\t\t\t\t\t'rrui__select__options-list-item',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__select__separator-option' : element && element.type === Select.Separator,\n\t\t\t\t\t\t'rrui__expandable__content--expanded' : expanded,\n\t\t\t\t\t\t// CSS selector performance optimization\n\t\t\t\t\t\t'rrui__select__options-list-item--expanded' : expanded\n\t\t\t\t\t}\n\t\t\t\t) }>\n\t\t\t\t{ button }\n\t\t\t</li>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\t// Renders the selected option\n\t// and possibly a transparent native `<select/>` above it\n\t// so that the native `<select/>` expands upon click\n\t// on the selected option\n\t// (in case of `nativeExpanded` setting).\n\trender_selected_item()\n\t{\n\t\tconst { nativeExpanded } = this.props\n\n\t\tconst selected = this.render_selected_item_only()\n\n\t\tif (!nativeExpanded)\n\t\t{\n\t\t\treturn selected\n\t\t}\n\n\t\tconst markup =\n\t\t(\n\t\t\t<div style={ styles.native_expanded_select_container }>\n\t\t\t\t{ this.render_static() }\n\t\t\t\t{ selected }\n\t\t\t</div>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\trender_selected_item_only()\n\t{\n\t\tconst\n\t\t{\n\t\t\tchildren,\n\t\t\tvalue,\n\t\t\tplaceholder,\n\t\t\tlabel,\n\t\t\tdisabled,\n\t\t\tautocomplete,\n\t\t\tconcise\n\t\t}\n\t\t= this.props\n\n\t\tconst\n\t\t{\n\t\t\texpanded,\n\t\t\tautocomplete_width,\n\t\t\tautocomplete_input_value\n\t\t}\n\t\t= this.state\n\n\t\tconst selected = this.get_selected_option()\n\t\tconst selected_label = this.get_selected_option_label()\n\n\t\tconst selected_text = selected ? selected_label : (placeholder || label)\n\n\t\tlet style = styles.selected\n\n\t\tif (autocomplete && expanded)\n\t\t{\n\t\t\t// style = { ...style, width: autocomplete_width + 'px' }\n\n\t\t\tconst markup =\n\t\t\t(\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tref={ ref => this.autocomplete = ref }\n\t\t\t\t\tplaceholder={ selected_text }\n\t\t\t\t\tvalue={ autocomplete_input_value }\n\t\t\t\t\tonChange={ this.on_autocomplete_input_change }\n\t\t\t\t\tonKeyDown={ this.on_key_down }\n\t\t\t\t\tstyle={ style }\n\t\t\t\t\tclassName={ classNames\n\t\t\t\t\t(\n\t\t\t\t\t\t'rrui__input',\n\t\t\t\t\t\t'rrui__select__selected',\n\t\t\t\t\t\t'rrui__select__selected--autocomplete',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t'rrui__select__selected--nothing'  : !selected_label,\n\t\t\t\t\t\t\t// CSS selector performance optimization\n\t\t\t\t\t\t\t'rrui__select__selected--expanded' : expanded,\n\t\t\t\t\t\t\t'rrui__select__selected--disabled' : disabled\n\t\t\t\t\t\t}\n\t\t\t\t\t) }/>\n\t\t\t)\n\n\t\t\treturn markup\n\t\t}\n\n\t\tconst markup =\n\t\t(\n\t\t\t<button\n\t\t\t\tref={ ref => this.selected = ref }\n\t\t\t\ttype=\"button\"\n\t\t\t\tdisabled={ disabled }\n\t\t\t\tonClick={ this.toggle }\n\t\t\t\tonKeyDown={ this.on_key_down }\n\t\t\t\tstyle={ style }\n\t\t\t\tclassName={ classNames\n\t\t\t\t(\n\t\t\t\t\t'rrui__input',\n\t\t\t\t\t'rrui__select__selected',\n\t\t\t\t\t{\n\t\t\t\t\t\t'rrui__select__selected--nothing' : !selected_label\n\t\t\t\t\t}\n\t\t\t\t) }>\n\n\t\t\t\t{/* http://stackoverflow.com/questions/35464067/flexbox-not-working-on-button-element-in-some-browsers */}\n\t\t\t\t<div\n\t\t\t\t\tstyle={ styles.selected_flex_wrapper }\n\t\t\t\t\tclassName=\"rrui__select__selected-content\">\n\n\t\t\t\t\t{/* Selected option label (or icon) */}\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle={ styles.selected_label }\n\t\t\t\t\t\tclassName=\"rrui__select__selected-label\">\n\t\t\t\t\t\t{ (concise && selected && selected.icon) ? React.cloneElement(selected.icon, { title: selected_label }) : selected_text }\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* An arrow */}\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={ classNames('rrui__select__arrow',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// CSS selector performance optimization\n\t\t\t\t\t\t\t'rrui__select__arrow--expanded': expanded\n\t\t\t\t\t\t}) }\n\t\t\t\t\t\tstyle={ styles.arrow }/>\n\t\t\t\t</div>\n\t\t\t</button>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\t// supports disabled javascript\n\trender_static()\n\t{\n\t\tconst\n\t\t{\n\t\t\tid,\n\t\t\tname,\n\t\t\tvalue,\n\t\t\tlabel,\n\t\t\tdisabled,\n\t\t\toptions,\n\t\t\tmenu,\n\t\t\ttoggler,\n\t\t\tfallback,\n\t\t\tnativeExpanded,\n\t\t\tchildren\n\t\t}\n\t\t= this.props\n\n\t\tif (menu)\n\t\t{\n\t\t\tconst markup =\n\t\t\t(\n\t\t\t\t<div\n\t\t\t\t\tclassName={ classNames\n\t\t\t\t\t({\n\t\t\t\t\t\t'rrui__rich__fallback' : fallback\n\t\t\t\t\t}) }>\n\t\t\t\t\t{toggler}\n\t\t\t\t</div>\n\t\t\t)\n\n\t\t\treturn markup\n\t\t}\n\n\t\tconst markup =\n\t\t(\n\t\t\t<select\n\t\t\t\tref={ ref => this.native = ref }\n\t\t\t\tid={ id }\n\t\t\t\tname={ name }\n\t\t\t\tvalue={ value_is_empty(value) ? Empty_value_option_value : value }\n\t\t\t\tdisabled={ disabled }\n\t\t\t\tonChange={ this.native_select_on_change }\n\t\t\t\tclassName={ classNames('rrui__input', 'rrui__select__native',\n\t\t\t\t{\n\t\t\t\t\t'rrui__select__native-expanded' : nativeExpanded,\n\t\t\t\t\t'rrui__rich__fallback'          : fallback\n\t\t\t\t}) }>\n\t\t\t\t{\n\t\t\t\t\toptions\n\t\t\t\t\t?\n\t\t\t\t\tthis.render_native_select_options(options, value_is_empty(value))\n\t\t\t\t\t:\n\t\t\t\t\tReact.Children.map(children, (child) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tif (!child)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst markup =\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\t<option\n\t\t\t\t\t\t\t\tclassName=\"rrui__select__native-option\"\n\t\t\t\t\t\t\t\tkey={ child.props.value }\n\t\t\t\t\t\t\t\tvalue={ child.props.value }>\n\t\t\t\t\t\t\t\t{ child.props.label }\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t)\n\n\t\t\t\t\t\treturn markup\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t</select>\n\t\t)\n\n\t\treturn markup\n\t}\n\n\trender_native_select_options(options, empty_option_is_selected)\n\t{\n\t\tconst { placeholder } = this.props\n\n\t\tlet empty_option_present = false\n\n\t\tconst rendered_options = options.map((option) =>\n\t\t{\n\t\t\tlet { value, label } = option\n\n\t\t\tif (value_is_empty(value))\n\t\t\t{\n\t\t\t\tempty_option_present = true\n\t\t\t\tvalue = Empty_value_option_value\n\t\t\t}\n\n\t\t\tconst markup =\n\t\t\t(\n\t\t\t\t<option\n\t\t\t\t\tclassName=\"rrui__select__native-option\"\n\t\t\t\t\tkey={ get_option_key(value) }\n\t\t\t\t\tvalue={ value }>\n\t\t\t\t\t{ label }\n\t\t\t\t</option>\n\t\t\t)\n\n\t\t\treturn markup\n\t\t})\n\n\t\tif (empty_option_is_selected && !empty_option_present)\n\t\t{\n\t\t\trendered_options.unshift\n\t\t\t(\n\t\t\t\t<option\n\t\t\t\t\tclassName=\"rrui__select__native-option\"\n\t\t\t\t\tkey={ get_option_key(undefined) }\n\t\t\t\t\tvalue=\"\">\n\t\t\t\t\t{ placeholder }\n\t\t\t\t</option>\n\t\t\t)\n\t\t}\n\n\t\treturn rendered_options\n\t}\n\n\tnative_select_on_change = (event) =>\n\t{\n\t\tconst { onChange } = this.props\n\n\t\tlet value = event.target.value\n\n\t\t// Convert back from an empty string to `undefined`\n\t\tif (value === Empty_value_option_value)\n\t\t{\n\t\t\t// `null` is not accounted for, use `undefined` instead.\n\t\t\tvalue = undefined\n\t\t}\n\n\t\tonChange(value)\n\t}\n\n\tresize_native_expanded_select = () =>\n\t{\n\t\t// For some strange reason 1px on the right side of the `<select/>`\n\t\t// still falls through to the underlying selected option label.\n\t\tReactDOM.findDOMNode(this.native).style.width = (ReactDOM.findDOMNode(this.selected).offsetWidth + 1) + 'px'\n\t}\n\n\tget_selected_option()\n\t{\n\t\tconst { value } = this.props\n\n\t\treturn this.get_option(value)\n\t}\n\n\tget_option(value)\n\t{\n\t\tconst { options, children } = this.props\n\n\t\tif (options)\n\t\t{\n\t\t\treturn options.filter(x => x.value === value)[0]\n\t\t}\n\n\t\tlet option\n\n\t\tReact.Children.forEach(children, function(child)\n\t\t{\n\t\t\tif (child.props.value === value)\n\t\t\t{\n\t\t\t\toption = child\n\t\t\t}\n\t\t})\n\n\t\treturn option\n\t}\n\n\tget_option_index(option)\n\t{\n\t\tconst { options, children } = this.props\n\n\t\tif (options)\n\t\t{\n\t\t\treturn options.indexOf(option)\n\t\t}\n\n\t\tlet option_index\n\n\t\tReact.Children.forEach(children, function(child, index)\n\t\t{\n\t\t\tif (child.props.value === option.value)\n\t\t\t{\n\t\t\t\toption_index = index\n\t\t\t}\n\t\t})\n\n\t\treturn option_index\n\t}\n\n\tget_selected_option_label()\n\t{\n\t\tconst { options } = this.props\n\n\t\tconst selected = this.get_selected_option()\n\n\t\tif (!selected)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (options)\n\t\t{\n\t\t\treturn selected.label\n\t\t}\n\n\t\treturn selected.props.label\n\t}\n\n\toverflown()\n\t{\n\t\tconst { options, maxItems } = this.props\n\n\t\treturn options.length > maxItems\n\t}\n\n\tscrollable_list_height(state = this.state)\n\t{\n\t\tconst { maxItems } = this.props\n\n\t\t// (Adding vertical padding so that it shows these `maxItems` options fully)\n\t\treturn (state.height - 2 * state.vertical_padding) * (maxItems / this.get_options().length) + state.vertical_padding\n\t}\n\n\tshould_animate()\n\t{\n\t\treturn true\n\n\t\t// return this.props.options.length >= this.props.transition_item_count_min\n\t}\n\n\ttoggle = (event, toggle_options = {}) =>\n\t{\n\t\tif (event)\n\t\t{\n\t\t\t// Don't navigate away when clicking links\n\t\t\tevent.preventDefault()\n\n\t\t\t// Not discarding the click event because\n\t\t\t// other expanded selects may be listening to it.\n\t\t\t// // Discard the click event so that it won't reach `document` click listener\n\t\t\t// event.stopPropagation() // doesn't work\n\t\t\t// event.nativeEvent.stopImmediatePropagation()\n\t\t}\n\n\t\tconst\n\t\t{\n\t\t\tdisabled,\n\t\t\tautocomplete,\n\t\t\toptions,\n\t\t\tvalue,\n\t\t\tfocusUponSelection,\n\t\t\tonToggle,\n\t\t\tnativeExpanded\n\t\t}\n\t\t= this.props\n\n\t\tif (nativeExpanded)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tif (disabled)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst { expanded } = this.state\n\n\t\tif (!expanded && autocomplete)\n\t\t{\n\t\t\tthis.setState\n\t\t\t({\n\t\t\t\t// The input value can't be `undefined`\n\t\t\t\t// because in that case React would complain\n\t\t\t\t// about it being an \"uncontrolled input\"\n\t\t\t\tautocomplete_input_value : undefined,\n\t\t\t\tmatching_options         : options\n\t\t\t})\n\n\t\t\t// if (!this.state.autocomplete_width)\n\t\t\t// {\n\t\t\t// \tthis.setState({ autocomplete_width: this.get_widest_label_width() })\n\t\t\t// }\n\t\t}\n\n\t\t// Deferring expanding the select upon click\n\t\t// because document.onClick should finish first,\n\t\t// otherwise `event.target` may be detached from the DOM\n\t\t// and it would immediately toggle back to collapsed state.\n\t\tsetTimeout(() =>\n\t\t{\n\t\t\tthis.setState\n\t\t\t({\n\t\t\t\texpanded: !expanded\n\t\t\t})\n\n\t\t\tif (!expanded && options)\n\t\t\t{\n\t\t\t\t// Focus either the selected option\n\t\t\t\t// or the first option in the list.\n\n\t\t\t\tconst focused_option_value = value || options[0].value\n\n\t\t\t\tthis.setState({ focused_option_value })\n\n\t\t\t\t// Scroll down to the focused option\n\t\t\t\tthis.scroll_to(focused_option_value)\n\t\t\t}\n\n\t\t\t// If it's autocomplete, then focus <input/> field\n\t\t\t// upon toggling the select component.\n\t\t\tif (autocomplete && !toggle_options.dont_focus_after_toggle)\n\t\t\t{\n\t\t\t\tif (!expanded || (expanded && focusUponSelection))\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(() =>\n\t\t\t\t\t{\n\t\t\t\t\t\t// Focus the toggler\n\t\t\t\t\t\tif (expanded)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selected.focus()\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.autocomplete.focus()\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t0)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (onToggle)\n\t\t\t{\n\t\t\t\tonToggle(!expanded)\n\t\t\t}\n\n\t\t\tif (toggle_options.callback)\n\t\t\t{\n\t\t\t\ttoggle_options.callback()\n\t\t\t}\n\t\t},\n\t\t0)\n\t}\n\n\titem_clicked(value, event)\n\t{\n\t\tif (event)\n\t\t{\n\t\t\tevent.preventDefault()\n\t\t}\n\n\t\tconst\n\t\t{\n\t\t\tdisabled,\n\t\t\tonChange,\n\t\t\tautocomplete,\n\t\t\tfocusUponSelection\n\t\t}\n\t\t= this.props\n\n\t\tif (disabled)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\t// Focus the toggler\n\t\tif (focusUponSelection)\n\t\t{\n\t\t\tif (autocomplete)\n\t\t\t{\n\t\t\t\tthis.autocomplete.focus()\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selected.focus()\n\t\t\t}\n\t\t}\n\n\t\tthis.toggle(undefined, { callback: () => onChange(value) })\n\t}\n\n\tdocument_clicked = (event) =>\n\t{\n\t\tconst autocomplete = ReactDOM.findDOMNode(this.autocomplete)\n\t\tconst selected_option = ReactDOM.findDOMNode(this.selected)\n\t\tconst options_list = ReactDOM.findDOMNode(this.list)\n\n\t\t// Don't close the select if its expander button has been clicked,\n\t\t// or if autocomplete has been clicked,\n\t\t// or if an option was selected from the list.\n\t\tif (options_list && options_list.contains(event.target)\n\t\t\t|| (autocomplete && autocomplete.contains(event.target))\n\t\t\t|| (selected_option && selected_option.contains(event.target)))\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tthis.setState({ expanded: false })\n\n\t\tconst { onToggle } = this.props\n\n\t\tif (onToggle)\n\t\t{\n\t\t\tonToggle(false)\n\t\t}\n\t}\n\n\t// Would have used `onBlur()` handler here\n\t// with `container.contains(event.relatedTarget)`,\n\t// but it has an IE bug in React.\n\t// https://github.com/facebook/react/issues/3751\n\t//\n\t// Therefore, using the hacky `document.onClick` handlers\n\t// and this `onKeyDown` Tab handler\n\t// until `event.relatedTarget` support is consistent in React.\n\t//\n\ton_key_down_in_container = (event) =>\n\t{\n\t\tif (event.ctrlKey || event.altKey || event.shiftKey || event.metaKey)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst { expanded } = this.state\n\n\t\tswitch (event.keyCode)\n\t\t{\n\t\t\t// Toggle on Tab out\n\t\t\tcase 9:\n\t\t\t\tif (expanded)\n\t\t\t\t{\n\t\t\t\t\tthis.toggle(undefined, { dont_focus_after_toggle: true })\n\n\t\t\t\t\tconst { onTabOut } = this.props\n\n\t\t\t\t\tif (onTabOut)\n\t\t\t\t\t{\n\t\t\t\t\t\tonTabOut(event)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn\n\t\t}\n\t}\n\n\ton_key_down = (event) =>\n\t{\n\t\tif (event.ctrlKey || event.altKey || event.shiftKey || event.metaKey)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tconst { options, value, autocomplete } = this.props\n\t\tconst { expanded, focused_option_value } = this.state\n\n\t\t// Maybe add support for `children` arrow navigation in future\n\t\tif (options)\n\t\t{\n\t\t\tswitch (event.keyCode)\n\t\t\t{\n\t\t\t\t// Select the previous option (if present) on up arrow\n\t\t\t\tcase 38:\n\t\t\t\t\tevent.preventDefault()\n\n\t\t\t\t\tconst previous = this.previous_focusable_option()\n\n\t\t\t\t\tif (previous)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.show_option(previous.value, 'top')\n\t\t\t\t\t\treturn this.setState({ focused_option_value: previous.value })\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\n\n\t\t\t\t// Select the next option (if present) on down arrow\n\t\t\t\tcase 40:\n\t\t\t\t\tevent.preventDefault()\n\n\t\t\t\t\tconst next = this.next_focusable_option()\n\n\t\t\t\t\tif (next)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.show_option(next.value, 'bottom')\n\t\t\t\t\t\treturn this.setState({ focused_option_value: next.value })\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\n\n\t\t\t\t// Collapse on Escape\n\t\t\t\t//\n\t\t\t\t// Maybe add this kind of support for \"Escape\" key in some future:\n\t\t\t\t//  hiding the item list, cancelling current item selection process\n\t\t\t\t//  and restoring the selection present before the item list was toggled.\n\t\t\t\t//\n\t\t\t\tcase 27:\n\t\t\t\t\t// Collapse the list if it's expanded\n\t\t\t\t\tif (this.state.expanded)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.toggle()\n\n\t\t\t\t\t\t// Restore focus when the list is collapsed\n\t\t\t\t\t\tsetTimeout\n\t\t\t\t\t\t(() =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.selected.focus()\n\t\t\t\t\t\t},\n\t\t\t\t\t\t0)\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\n\n\t\t\t\t// on Enter\n\t\t\t\tcase 13:\n\t\t\t\t\t// Choose the focused item on Enter\n\t\t\t\t\tif (expanded)\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault()\n\n\t\t\t\t\t\t// If an item is focused\n\t\t\t\t\t\t// (which may not be a case\n\t\t\t\t\t\t//  when autocomplete is matching no items)\n\t\t\t\t\t\t// (still for non-autocomplete select\n\t\t\t\t\t\t//  it is valid to have a default option)\n\t\t\t\t\t\tif (this.get_options() && this.get_options().length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t// Choose the focused item\n\t\t\t\t\t\t\tthis.item_clicked(focused_option_value)\n\t\t\t\t\t\t\t// And collapse the select\n\t\t\t\t\t\t\tthis.toggle()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Else it should have just submitted the form on Enter,\n\t\t\t\t\t// but it wouldn't because the select element activator is a <button/>\n\t\t\t\t\t// therefore hitting Enter while being focused on it just pushes that button.\n\t\t\t\t\t// So submit the enclosing form manually.\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tif (submit_parent_form(ReactDOM.findDOMNode(this.select)))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\n\n\t\t\t\t// on Spacebar\n\t\t\t\tcase 32:\n\t\t\t\t\t// Choose the focused item on Enter\n\t\t\t\t\tif (expanded)\n\t\t\t\t\t{\n\t\t\t\t\t\t// only if it it's an `options` select\n\t\t\t\t\t\t// and also if it's not an autocomplete\n\t\t\t\t\t\tif (this.get_options() && !autocomplete)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tevent.preventDefault()\n\n\t\t\t\t\t\t\t// `focused_option_value` could be non-existent\n\t\t\t\t\t\t\t// in case of `autocomplete`, but since\n\t\t\t\t\t\t\t// we're explicitly not handling autocomplete here\n\t\t\t\t\t\t\t// it is valid to select any options including the default ones.\n\t\t\t\t\t\t\tthis.item_clicked(focused_option_value)\n\t\t\t\t\t\t\tthis.toggle()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Expand the select otherwise\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tevent.preventDefault()\n\t\t\t\t\t\tthis.toggle()\n\t\t\t\t\t}\n\n\t\t\t\t\treturn\n\t\t\t}\n\t\t}\n\t}\n\n\tget_options()\n\t{\n\t\tconst { autocomplete, autocompleteShowAll, maxItems, options } = this.props\n\t\tconst { matching_options } = this.state\n\n\t\tif (!autocomplete)\n\t\t{\n\t\t\treturn options\n\t\t}\n\n\t\tif (autocompleteShowAll)\n\t\t{\n\t\t\treturn matching_options\n\t\t}\n\n\t\treturn matching_options.slice(0, maxItems)\n\t}\n\n\t// Get the previous option (relative to the currently focused option)\n\tprevious_focusable_option()\n\t{\n\t\tconst options = this.get_options()\n\t\tconst { focused_option_value } = this.state\n\n\t\tlet i = 0\n\t\twhile (i < options.length)\n\t\t{\n\t\t\tif (options[i].value === focused_option_value)\n\t\t\t{\n\t\t\t\tif (i - 1 >= 0)\n\t\t\t\t{\n\t\t\t\t\treturn options[i - 1]\n\t\t\t\t}\n\t\t\t}\n\t\t\ti++\n\t\t}\n\t}\n\n\t// Get the next option (relative to the currently focused option)\n\tnext_focusable_option()\n\t{\n\t\tconst options = this.get_options()\n\t\tconst { focused_option_value } = this.state\n\n\t\tlet i = 0\n\t\twhile (i < options.length)\n\t\t{\n\t\t\tif (options[i].value === focused_option_value)\n\t\t\t{\n\t\t\t\tif (i + 1 < options.length)\n\t\t\t\t{\n\t\t\t\t\treturn options[i + 1]\n\t\t\t\t}\n\t\t\t}\n\t\t\ti++\n\t\t}\n\t}\n\n\t// Scrolls to an option having the value\n\tscroll_to(value)\n\t{\n\t\tconst option_element = ReactDOM.findDOMNode(this.options[get_option_key(value)])\n\n\t\t// If this option isn't even shown\n\t\t// (e.g. autocomplete)\n\t\t// then don't scroll to it because there's nothing to scroll to.\n\t\tif (!option_element)\n\t\t{\n\t\t\treturn\n\t\t}\n\n\t\tReactDOM.findDOMNode(this.list).scrollTop = option_element.offsetTop\n\t}\n\n\t// Fully shows an option having the `value` (scrolls to it if neccessary)\n\tshow_option(value, gravity)\n\t{\n\t\tconst option_element = ReactDOM.findDOMNode(this.options[get_option_key(value)])\n\t\tconst list = ReactDOM.findDOMNode(this.list)\n\n\t\tswitch (gravity)\n\t\t{\n\t\t\tcase 'top':\n\t\t\t\tif (option_element.offsetTop < list.scrollTop)\n\t\t\t\t{\n\t\t\t\t\tlist.scrollTop = option_element.offsetTop\n\t\t\t\t}\n\t\t\t\treturn\n\n\t\t\tcase 'bottom':\n\t\t\t\tif (option_element.offsetTop + option_element.offsetHeight > list.scrollTop + list.offsetHeight)\n\t\t\t\t{\n\t\t\t\t\tlist.scrollTop = option_element.offsetTop + option_element.offsetHeight - list.offsetHeight\n\t\t\t\t}\n\t\t\t\treturn\n\t\t}\n\t}\n\n\t// Calculates height of the expanded item list\n\tcalculate_height()\n\t{\n\t\tconst { options } = this.props\n\n\t\tconst list_dom_node = ReactDOM.findDOMNode(this.list)\n\t\tconst border = parseInt(window.getComputedStyle(list_dom_node).borderTopWidth)\n\t\tconst height = list_dom_node.scrollHeight // + 2 * border // inner height + 2 * border\n\n\t\tconst vertical_padding = parseInt(window.getComputedStyle(list_dom_node.firstChild).paddingTop)\n\n\t\t// For things like \"accordeon\".\n\t\t//\n\t\t// const images = list_dom_node.querySelectorAll('img')\n\t\t//\n\t\t// if (images.length > 0)\n\t\t// {\n\t\t// \treturn this.preload_images(list_dom_node, images)\n\t\t// }\n\n\t\tconst state = { height, vertical_padding, border }\n\n\t\tif (this.is_scrollable() && options && this.overflown())\n\t\t{\n\t\t\tstate.list_height = this.scrollable_list_height(state)\n\t\t}\n\n\t\tthis.setState(state)\n\t}\n\n\tis_scrollable()\n\t{\n\t\tconst { menu, autocomplete, autocompleteShowAll, scroll } = this.props\n\n\t\treturn !menu && (autocomplete && autocompleteShowAll || !autocomplete) && scroll\n\t}\n\n\t// This turned out not to work for `autocomplete`\n\t// because not all options are ever shown.\n\t// get_widest_label_width()\n\t// {\n\t// \t// <ul/> -> <li/> -> <button/>\n\t// \tconst label = ReactDOM.findDOMNode(this.list).firstChild.firstChild\n\t//\n\t// \tconst style = getComputedStyle(label)\n\t//\n\t// \tconst width = parseFloat(style.width)\n\t// \tconst side_padding = parseFloat(style.paddingLeft)\n\t//\n\t// \treturn width - 2 * side_padding\n\t// }\n\n\tget_matching_options(options, value)\n\t{\n\t\t// If the autocomplete value is `undefined` or empty\n\t\tif (!value)\n\t\t{\n\t\t\treturn options\n\t\t}\n\n\t\tvalue = value.toLowerCase()\n\n\t\treturn options.filter(({ label, verbose }) =>\n\t\t{\n\t\t\treturn (verbose || label).toLowerCase().indexOf(value) >= 0\n\t\t})\n\t}\n\n\ton_autocomplete_input_change = (event) =>\n\t{\n\t\tconst { options } = this.props\n\t\tconst input = event.target.value\n\t\tconst matching_options = this.get_matching_options(options, input)\n\n\t\tthis.setState\n\t\t({\n\t\t\tautocomplete_input_value: input,\n\t\t\tmatching_options,\n\t\t\tfocused_option_value: matching_options.length > 0 ? matching_options[0].value : undefined\n\t\t})\n\t}\n\n\t// // https://github.com/daviferreira/react-sanfona/blob/master/src/AccordionItem/index.jsx#L54\n\t// // Wait for images to load before calculating maxHeight\n\t// preload_images(node, images)\n\t// {\n\t// \tlet images_loaded = 0\n\t//\n\t// \tconst image_loaded = () =>\n\t// \t{\n\t// \t\timages_loaded++\n\t//\n\t// \t\tif (images_loaded === images.length)\n\t// \t\t{\n\t// \t\t\tthis.setState\n\t// \t\t\t({\n\t// \t\t\t\theight: this.props.expanded ? node.scrollHeight : 0\n\t// \t\t\t})\n\t// \t\t}\n\t// \t}\n\t//\n\t// \tfor (let i = 0; i < images.length; i += 1)\n\t// \t{\n\t// \t\tconst image = new Image()\n\t// \t\timage.src = images[i].src\n\t// \t\timage.onload = image.onerror = image_loaded\n\t// \t}\n\t// }\n}\n\nSelect.Separator = function(props)\n{\n\treturn <div className=\"rrui__select__separator\" style={styles.separator}/>\n}\n\nconst styles = styler\n`\n\twrapper\n\t\t// Sometimes (e.g. when using mobile dropdown menus)\n\t\t// \"position: relative\" could be overridden to \"static\"\n\t\t// to allow for the menu stretching to full screen width.\n\t\t// Therefore it was moved to CSS from inline styles.\n\n\t\t-webkit-user-select : none\n\t\t-moz-user-select    : none\n\t\t-ms-user-select     : none\n\t\tuser-select         : none\n\n\tlist\n\t\tlist-style-type : none\n\t\toverflow-x      : hidden\n\n\tselected\n\t\tbox-sizing : border-box\n\n\tselected_flex_wrapper\n\t\tdisplay     : flex\n\t\talign-items : center\n\n\tselected_label\n\t\tflex          : 1\n\t\toverflow      : hidden\n\t\ttext-overflow : ellipsis\n\n\tarrow\n\n\tseparator\n\t\tpadding     : 0\n\t\tline-height : 0\n\t\tfont-size   : 0\n\n\tlabel\n\t\tposition    : absolute\n\t\twhite-space : nowrap\n\n\t\t-webkit-user-select : none\n\t\t-moz-user-select    : none\n\t\t-ms-user-select     : none\n\t\tuser-select         : none\n\n\t\t// Vertically align\n\t\tdisplay     : flex\n\t\talign-items : center\n\t\theight      : 100%\n\n\tnative_expanded_select_container\n\t\tdisplay : inline-block\n`\n\n// There can be an `undefined` value,\n// so just `{ value }` won't do here.\nfunction get_option_key(value)\n{\n\treturn value_is_empty(value) ? '@@rrui/select/undefined' : value\n}\n\nfunction value_is_empty(value)\n{\n\treturn value === null || value === undefined\n}"]}